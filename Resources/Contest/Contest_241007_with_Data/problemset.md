##### 

|    题目名称    | illu510n reference | Florr.io reference | USACO reference | Dilation reference |
| :------------: | :----------------: | :----------------: | :-------------: | :----------------: |
|    题目类型    |        普通        |        普通        |      普通       |        普通        |
|    输入文件    |    illusion.in     |     florrio.in     |    usaco.in     |    dilation.in     |
|    输出文件    |    illusion.out    |    florrio.out     |    usaco.out    |    dilation.out    |
|    时空限制    |     1.5s 256MB     |     0.8s 512MB     |    1s 512MB     |      2s 512MB      |
|   测试点数目   |         20         |         20         |        8        |         9          |
| 测试点是否等分 |         是         |         是         |       否        |         否         |

编译选项：

```cpp
-std=c++14 -Wl,-stack=123456789 -O2
```

##### 1.保证所有题目时限大于 std 运行时间的 $2$ 倍。

##### 2.AK 后请不要大声喧哗。

### A. Yet another illu510n reference

给定一棵树，初始只含一个节点，编号为 $1$ ，初始权值为 $0$ ，设树的大小为 $n$ 。

$q$ 次操作：

- $1 \ x$ ，在 $x$ 下挂一个节点，编号为 $n+1$ ，初始权值为 $0$ 。

- $2 \ x \ v$ ，将当前 $x$ 子树中节点的权值加上 $v$ 。

求所有操作完成后每个节点的点权。

$T$ 组数据。 

#### 输入格式

第一行包含一个整数 $T$ 。

对于每组数据，第一行包含一个数 $q$ 。

以下 $q$ 行，表示上述操作。

#### 输出格式

输出 $n$ 个数，表示每个点的权值。$n$ 的定义见上述。

#### 样例输入 1

```cpp
2
9
2 1 3
1 1
2 2 1
1 1
2 3 2
1 3
2 1 4
1 3
2 3 2
5
2 1 1
1 1
2 1 -1
1 1
2 1 1
```

#### 样例输出 1

```cpp
7 5 8 6 2 
1 0 1 
```

#### 样例解释

第一组数据最终树的形态及权值如下：

![pic1](D:\florr.io\contest\contest\picture\pic1.png)

#### 数据范围

令 $N= \sum q$ 。

对于 $30 \%$ 的数据，$N \le 5 \times 10^3$ 。

对于另外 $15 \%$ 的数据，保证 $1$ 操作不超过 $5 \times 10^3$ 次。

对于另外 $15 \%$ 的数据，保证 $2$ 操作不超过 $5 \times 10^3$ 次。

对于另外 $20 \%$ 的数据，$N \le 10^5$ 。	

对于 $100 \%$ 的数据，$N \le 5 \times 10^5,T \le 10^3,v\le 10^9$ 。

### B. Yet another Florr.io reference

有两个管道和 $n$ 个小球，你需要将小球轮流放进管道中。小球共有 $k$ 种颜色。

对于每个小球，在其被放置时，若在该小球放置管道中位于最上端（即这一管道上次放入的球）与该小球颜色相同，则产生 $b_k$ 的代价，否则产生 $a_k$ 的代价。$k$ 为该小球的颜色。

第 $i$ 个小球的颜色为 $x_i$ 。

求最小代价。

#### 输入格式

第一行包含两个整数 $n,k$ 。

第二行包含 $n$ 个整数 $x_i$ 。

第三行包含 $k$ 个整数 $a_i$ 。

第四行包含 $k$ 个整数 $b_i$ 。

保证 $a_i \ge b_i$ 。

#### 输出格式

输出一个数，即最小代价。

#### 样例输入 1

```cpp
6 3
3 1 2 3 2 1
4 6 8
3 4 5
```

#### 样例输出 1

```cpp
31
```

##### 样例解释

$6$ 个小球分别放到 $A,B,B,A,B,B$ 管道里，总代价为 $8+4+6+5+4+4=31$ 。

#### 数据范围

对于 $15 \%$ 的数据，$n \le 20$ 。

对于 $30 \%$ 的数据，$n \le 5 \times 10^2$ 。

对于 $45\%$ 的数据，$n \le 5 \times 10^3$ 。

对于另外 $10 \%$ 的数据，$k \le 2$ 。

对于 $65\%$ 的数据，$k \le 50$ 。

对于 $80 \%$ 的数据，$n,k \le 3 \times 10^5$ 。

对于 $100 \%$ 的数据，$1 \le n,k \le 2 \times 10^6,1\le a_i,b_i \le 10^9,1\le x_i \le k$ 。

### C. Yet another USACO reference

Farmer John 拥有一块 $n \times m$ 的农场，分为 $nm$ 块，每块上有一只奶牛。每一头奶牛的品种是根西岛 `G` 或荷斯坦 `H` 中的一种。

为了管理这些奶牛，Farmer John 会在农场中放置一些栅栏。栅栏要么放在横着的两行之间，要么放在竖着的两列之间，**必须放完整行或整列**。显然，共有 $2^{n+m-2}$ 种放置栅栏的方式。

Farmer John 认为一种方案是合法的，当且仅当每一个被划分出的联通块中，均有恰好 $2$ 只荷斯坦奶牛。因为 Farmer John 还要给他的奶牛清理杂草，请你帮助他计算出放置栅栏的合法方案数，对 $10^9+7$ 取模。

#### 输入格式

第一行包含两个整数 $n,m$ 。

以下 $n$ 行，每行包含一个长度为 $m$ 的字符串，表示农场的奶牛分布。

#### 输出格式

输出一个数，表示放置栅栏的合法方案数。

#### 样例输入 1

```cpp
4 4
GHGH
GGGG
HGHG
GGGG
```

#### 样例输入 2

```cpp
3
```

#### 样例解释：

![pic2](D:\florr.io\contest\contest\picture\pic2.png)

#### 数据范围

本题有subtask 。

| subtask ID |         限制          | 分数 |
| :--------: | :-------------------: | :--: |
|     1      |     $n,m \le 10$      | $8$  |
|     2      |      $n \le 10$       | $16$ |
|     3      | $H$ 的数量不超过 $4$  | $8$  |
|     4      | $H$ 的数量不超过 $20$ | $12$ |
|     5      |   $H$ 的数量为奇数    | $8$  |
|     6      |     $n,m \le 100$     | $16$ |
|     7      |    $n,m \le 1000$     | $16$ |
|     8      | $2 \le n,m \le 3000$  | $16$ |

### D. Yet another Dilation reference

为了玩到 2026.4.26 更新的 《Antimatter Dimensions : The Gensh1n 1mpact Update》，你需要完成一个任务。

给定一颗 $n$ 个点的树，你要给所有点染色。

你有一个老头和一个豆。

一开始，你要选择一个节点开始并把老头和豆放在这个节点上。该节点初始被标记。

你可以不断进行以下的操作之一，直到所有节点都被标记；

1. 将豆移动到与所在节点相邻的节点，并标记之；这种操作产生 $1$ 的代价；
2. 把豆移动到老头所在的节点；这种操作产生 $0$ 的代价；
3. 把老头移动到豆所在的节点；这种操作产生 $0$ 的代价；

求将所有点标记的最少代价。

#### 输入格式

第一行包含一个整数 $n$ 。

以下 $n-1$ 行，每行描述一条边 $(u,v)$ 。

#### 输出格式

一行一个数，表示答案。

#### 样例输入1

```cpp
6
1 2
2 3
2 4
4 5
1 6
```

#### 样例输出1

```cpp
5
```

#### 样例解释

以下为操作序列。$2 \ u$ 表示 $2$ 操作指定节点为 $u$ 。选定的初始节点为 $1$ 。

```cpp
2 6
3
2 2
4
2 3
3
2 4
2 5
```

#### 数据范围

本题有subtask 。

| subtask ID |                        限制                        | 分数 |
| :--------: | :------------------------------------------------: | :--: |
|     1      |                     $n \le 10$                     | $5$  |
|     2      |                     $n \le 20$                     | $10$ |
|     3      |                    $n \le 10^3$                    | $10$ |
|     4      |               $n \le 5 \times 10^3$                | $15$ |
|     5      |                      $u_i=1$                       | $5$  |
|     6      |    $u_i=i+1,v_i=\lfloor \dfrac{i+1}{2}\rfloor$     | $5$  |
|     7      |        $u_i=i+1,v_i$ 在 $[1,i]$ 中均匀随机         | $10$ |
|     8      |                   $n \le 397982$                   | $15$ |
|     9      | $2 \le n \le 10^6,u_i\neq v_i,1\le u_i ,v_i \le n$ | $25$ |