# Nov. wyz Round I



> 像我这样优秀的人，本该灿烂过一生。
>
> 怎么二十多年到头来，还在人海里 浮沉。
>
> 像我这样聪明的人，早就告别了单纯。
>
> 怎么还是用了一段情，去换 一身伤痕。
>
> 像我这样庸俗的人，从不喜欢装深沉。
>
> 怎么偶尔听到老歌时，忽然也晃了神。
>
> 像我这样懦弱的人，凡事都要留几分。
>
> 怎么曾经也会为了谁，想过奋不顾身。
>
> <div ailgn = "right"> —— 毛不易 《像我这样的人》 </div>



|                    |    远旅休憩中的邂逅    |         借          |       无问       |     一程山路      |       入海       |
| :----------------: | :--------------------: | :-----------------: | :--------------: | :---------------: | :--------------: |
|    **英文名称**    |   $\text{encounter}$   |   $\text{borrow}$   |   $\text{ask}$   |   $\text{ghat}$   |   $\text{sea}$   |
|   **输入文件名**   | $\text{encounter.in}$  | $\text{borrow.in}$  | $\text{ask.in}$  | $\text{ghat.in}$  | $\text{sea.in}$  |
|   **输出文件名**   | $\text{encounter.out}$ | $\text{borrow.out}$ | $\text{ask.out}$ | $\text{ghat.out}$ | $\text{sea.out}$ |
|    **时间限制**    |      $\text{1s}$       |     $\text{1s}$     |   $\text{1s}$    |    $\text{1s}$    |   $\text{1s}$    |
|    **空间限制**    |     $\text{512MB}$     |   $\text{512MB}$    |  $\text{512MB}$  |  $\text{512MB}$   |  $\text{512MB}$  |
|   **测试点数量**   |          $4$           |         $4$         |       $25$       |        $3$        |        7         |
| **测试点是否等分** |           否           |         否          |        是        |        否         |        否        |

## 注意事项

- 提交前要建立子文件夹，打开文件读写。
- 主函数的返回类型必须是 `int` 或 `signed`，返回值必须是 `0`。
- 本地测试环境为 `-std=c++14 -O2`，栈空间与空间限制一致。
- 本次测试的比较模式为 `逐行比较模式（忽略多余空格和制表符）`。
- 文件大小不得超过 `100KB`。
- 所有题目不卡常，时限开到了 `std` 两倍以上。

## 远旅休憩中的邂逅（encounter）

### 题目背景

> 你的故事我都记得，我都记得
>
> 就像被写在脑海的书页中
>
> 我都记得，我能读懂，即便还有一丝困惑
>
> 偶然一天 雨中相逢
>
> 淋湿的你 脸上笑容依旧
>
> 握住双手，天空 放晴了
>
> <div align = "right"> —— 泠鸢yousa 《远旅休憩中的邂逅》 </div>

### 题目描述

**罗辑** 抛弃白蓉，自己驾着车随意地开上盘山公路，左绕右绕就把车子绕坏了。

想象中的 **庄颜** 走了出来，与他一起坐在火堆旁边，讲述着各自的故事。

这些故事，罗辑至今仍然记得。那柴火中迸溅的火星闪耀，萤火虫般盘旋飞舞，然后黯然掉在脚边。而那烧得并不旺的篝火，就像壁炉，仍映出来庄颜的脸庞……

据罗辑回忆，他们当时的邂逅，就如同一抹霞光（当然是晚霞），亘古地照耀在他的心上。

他说，当时有这样一个故事引起了他的注意：

古罗马有一个从 $1$ 到 $n$ 的序列，当时的著名数学业余爱好者 **老顽童** 对 **最大公因子** 十分感兴趣。他希望每一次将序列中 $\gcd\limits_{i=1}^n a_i$ 写在黑板上，然后删去其中的一个数。例如，序列为 `1 2 3` 时，最开始应写下 $\gcd(1,2,3) = 1$，然后删去 $2$，序列变成 `1 3`，写下 $\gcd(1,3) = 1$，然后删去 $1$，序列变成 `3`，最后写下 $3$ 即可。

他希望这个序列的字典序尽可能大（字典序指从第一位开始比较，直到找到不同），但是他的职业是画家，并不会处理巨大的数据，因此他希望你能帮帮他，并承诺如果你做到了，可以成为齐白石老人家的第五代弟子。

**形式化题意** 给定一个 $n$，对于 $1\dots n$ 的排列进行 $n$ 次以下操作：写下这个序列的 $\gcd$，然后删去一个数，直到没有数。问写下的 $\gcd$ 构成的最大字典序序列是什么。

### 输入描述

第一行两个数 $n,t$，其中 $t\in \{0,1\}$。$t$ 的含义见 **输出描述**。

### 输出描述

如果 $t=0$，则输出一行 $n$ 个数表示字典序最大的序列。

如果 $t=1$，则输出一行一个数，记字典序最大的序列为 $b_i$，则你需要输出 $\bigoplus\limits_{i=1}^n i\times b_i$。

### 输入输出样例

#### 输入 1

```
4 0
```

#### 输出 1

```
1 1 2 4
```

### 数据范围

|     子任务编号     | $n\le$ | $t=$ | 分值 |
| :----------------: | :----: | :--: | :--: |
| $\text{subtask 1}$ |  $10$  |  0   |  10  |
| $\text{subtask 2}$ | $10^6$ |  0   |  30  |
| $\text{subtask 3}$ | $10^6$ |  1   |  30  |
| $\text{subtask 4}$ | $10^7$ |  1   |  30  |













## 借（borrow）

### 题目背景

> 可是啊总有那风吹不散的认真
>
> 总有大雨也不能抹去的泪痕
>
> 有一天太阳会升起，在某个清晨
>
> 一道彩虹，两个人
>
> <div align = "right"> —— 毛不易 《借》 </div>

### 题目描述

$\text{W}$ 总走在奔波的路上，追随者 $\text{S}$ 的步伐。

他在这段时间一共会进行 $q$ 段行程，每一次可以描述为 $(u,v)$，表示需要从 $u$ 到达 $v$。

而众所不周知的是，$\text{W}$ 所在的 $\text{A}$ 国有一个特殊的道路管理机制。

$\text{A}$ 国一共有 $n$ 个城市和 $m$ 条道路，其中一条道路可以被描述为 $(u,v,c)$ 表示连接 $(u,v)$ 的无向边，且该边的所属系统为 $c$，保证所有的 $c\le m$。

而 $\text{A}$ 国每一天会随机一个数 $x$，只有 $c=x$ 的道路才可以使用。

但是 $\text{W}$ 并不能够等太久，因此，他希望知道对于每一次询问 $(u,v)$，有多少种 $x$ 使得他可以从 $u$ 走到 $v$。

**注意，不保证没有重边或自环。**

### 输入格式

第一行三个数 $n,m,q$，含义见 **题目描述**。

接下来 $m$ 行每行三个数描述一条道路 $(u,v,w)$。

再接下来 $q$ 行每行两个数 $u,v$ 描述一次询问。

### 输出格式

你一共需要输出 $q$ 行每行 $q$ 个数，代表每个询问的答案。

### 样例输入输出

#### 输入 1

```
4 5 3
1 2 1
1 2 2
2 3 1
2 3 3
2 4 3
1 2
3 4
1 4
```

#### 输出 1

```
2
1
0
```

#### 输入 2

```
5 7 5
1 5 1
2 5 1
3 5 1
4 5 1
1 2 2
2 3 2
3 4 2
1 5
5 1
2 5
1 5
1 4
```

#### 输出 2

```
1
1
1
1
2
```



### 数据范围

|     子任务编号     |     $n\le$     |     $m\le$     |     $q\le$     |  特殊性质  | 分值 |
| :----------------: | :------------: | :------------: | :------------: | :--------: | :--: |
| $\text{subtask 1}$ | $5\times 10^2$ | $5\times 10^2$ |     $500$      |    暴力    |  10  |
| $\text{subtask 2}$ |     $10^3$     |     $10^5$     |     $10^5$     |    暴力    |  20  |
| $\text{subtask 3}$ |     $10^5$     |     $10^5$     |     $10^5$     | $\text{A}$ |  30  |
| $\text{subtask 4}$ |     $10^5$     | $2\times 10^5$ | $2\times 10^5$ |   最难做   |  40  |

**特殊性质 A**：保证颜色数量 $\le 10$。

对于所有数据，满足 $n,m,q\le 10^5$，$c\le m$，$1\le u,v \le n$，对于询问，保证 $u\ne v$。















































## 无问（ask）

### 题目背景

> 如果光，已忘了要将前方照亮，你会握着我的手吗。
>
> 如果路，会通往不知名的地方，你会跟我一起走吗。
>
> 就像手边落满了灰尘的，某一本书。
>
> 它可曾单薄地承载了，谁的酸楚。
>
> 尽管岁月无声，流向迟暮。
>
> 它会让你想起，你的归途。
>
> <div align = "right"> —— 毛不易 《无问》 </div>

### 题目描述

与题目背景不一样的是，这个题有很多询问。

首先，我们设数组 $a_{n,m}$ 的定义如下：
$$
a_{n,m} = \operatorname{mex}(\{a_{i,m} \mid i\in[1,n)\}\cup \{a_{n,j}\mid j\in[1,m)\})
$$
其中 $\operatorname{mex}(S)$ 表示 最小的 $S$ 中未出现的 **正整数**。

先在，有 $q$ 次询问，每次询问形如 $x_1,y_1,x_2,y_2,k$ 表示你需要求出：
$$
\sum_{i=x_1}^{x_2} \sum_{j=y_1}^{y_2} [a_{i,j}\le k] a_{i,j} \pmod{10^9 + 7}
$$

### 输入描述

第一行一个整数 $q$ 表示询问的个数。

接下来 $q$  行每行 $5$ 个数 $x_1,y_1,x_2,y_2,k$，含义见题目描述。

### 输出描述

对于每一次询问，输出一行表示答案。

### 样例输入输出

#### 输入 1

```
4
1 1 1 1 1
3 2 5 4 5
1 1 5 5 10000
1 4 2 5 2
```

#### 输出 1

```
1
13
93
0
```

#### 输入 2

见下发文件中的 `ex_ask1.in`，该测试样例满足测试点 $1\sim 2$ 的性质。

#### 输出 2

见下发文件中的 `ex_ask1.out`，该测试样例满足测试点 $1\sim 2$ 的性质。

#### 输入 3

见下发文件中的 `ex_ask2.in`，该测试样例满足测试点 $6\sim 8$ 的性质。

#### 输出 3

见下发文件中的 `ex_ask2.out`，该测试样例满足测试点 $6\sim 8$ 的性质。

#### 输入 4

见下发文件中的 `ex_ask3.in`，该测试样例满足测试点 $11\sim 15$ 的性质。

#### 输出 4

见下发文件中的 `ex_ask3.out`，该测试样例满足测试点 $11\sim 15$ 的性质。

#### 输入 5

见下发文件中的 `ex_ask4.in`，该测试样例满足测试点 $20\sim 25$ 的性质。

#### 输出 5

见下发文件中的 `ex_ask4.out`，该测试样例满足测试点 $20\sim 25$ 的性质。

### 数据范围

| 测试点编号  |     $q\le$     | $n,m\le$  |      $k\le$       |              特殊性质              | 分值 |
| :---------: | :------------: | :-------: | :---------------: | :--------------------------------: | :--: |
|  $1\sim 2$  |     $100$      |   $100$   | $2\times 10^{18}$ |                暴力                |  8   |
|  $3\sim 5$  |     $500$      |   $500$   | $2\times 10^{18}$ |             发现了什么             |  12  |
|  $6\sim 8$  | $2\times 10^4$ | $10^{18}$ | $2\times 10^{18}$ |       保证 $x_1=x_2,y_1=y_2$       |  12  |
| $9\sim 10$  | $2\times 10^4$ | $10^{18}$ | $2\times 10^{18}$ |            $x_1=x_2=1$             |  8   |
| $11\sim 15$ |      $30$      | $10^{18}$ | $2\times 10^{18}$ | 保证 $x_1=y_1 = 1$，$x_2=y_2 =2^n$ |  20  |
| $16\sim 18$ |      $1$       | $10^{18}$ | $2\times 10^{18}$ |               $q=1$                |  12  |
|    $19$     | $2\times 10^4$ | $10^{18}$ |        $0$        |               最好做               |  4   |
| $20\sim 25$ | $2\times 10^4$ | $10^{18}$ | $2\times 10^{18}$ |               最难做               |  24  |

对于 $100\%$ 的数据，满足 $1\le x_1\le x_2\le 10^{18}$，$1\le y_1\le y_2\le 10^{18}$，$q\le 5\times 10^4$，$k\le 10^{18}$。





























## 一程山路（ghat）

### 题目背景

> 青石板留着谁的梦啊，一场秋雨，又落一地花
>
> 旅人匆匆的赶路啊，走四季，访人家
>
> 潺潺流水终于跨过了远山一座座
>
> 仿佛多年之后，你依然执着
>
> 白云是否也听过你的诉说
>
> 笑着你，笑着我
>
> <div align = "right"> —— 毛不易 《一程山路》 </div>

### 题目描述

你在 $\text{Minecraft}$ 中建有一台刷冰机。

这个刷冰机有 $n$ 行 $m$ 列，刚开始你会有一个 $n\times m$ 的表格，其中 `.` 表示水，`X` 表示冰。

在这之后的 $k$ 秒内，都会有一格 $(x,y)$ 变成冰。

而你正在紧急征调一部分水源作为刷冰机的版本迭代，这部分被要求必须是正方形，且内部不能有冰。

因此，你希望知道每秒 **之后**，最大的能作为刷冰机版本迭代部分的正方形的边长是多少。

### 输入格式

第一行三个数 $n,m,k$，含义见 **题目描述**。

接下来一个 $n\times m$ 的矩阵。

然后 $k$ 行每行两个数 $(x,y)$ 表示结冰的地区。

### 输出格式

对于每一秒之后，回答最大正方形的边长。

### 输入输出样例

#### 输入 1

```
7 8 4
........
X.....X.
........
........
.X......
........
........
1 5
6 4
3 5
4 6
```

#### 输出 1

```
5
4
4
3
```

### 数据范围

|     子任务编号     | $n\le$ | $m\le$ | $k\le$ | 特殊性质 | 分数 |
| :----------------: | :----: | :----: | :----: | :------: | :--: |
| $\text{subtask 1}$ | $100$  | $100$  | $100$  |   暴力   |  10  |
| $\text{subtask 2}$ | $500$  | $500$  | $500$  |   暴力   |  40  |
| $\text{subtask 3}$ | $2000$ | $2000$ | $2000$ |   正解   |  50  |
