# WJC's New Round
懒得找图了。。。

but，由于 $\texttt{wjc}$ 被折磨的不轻，他也决定要折磨折磨你们，于是有了这场~~码量不短的~~比赛，都是板子题，考验大家代码功夫（手快点）。

有没有300分大佬让我sto%%\bx\bx\bx%%orz,~~AK也不是不可能~~

| | a | b | c | d |
 :-----------: | :----------- | :----------- | :----------- | :----------- 
  源程序/输入/输出文件名| a.cpp/in/out |b.cpp/in/out|c.cpp/in/out|d.cpp/in/out
  测试点数目/个|2|10|10|10
  测试点等分|否|是|是|是
  时间限制/s| 1|1|1|8
 空间限制/MB |256|256|256|256

1. 题目均为传统题，编译环境$\texttt{-std=c++14 -O2}$
2. 建议先动态规划一下做题时间和顺序，因为都是一眼，所以**最好先把题看完**

<div STYLE="page-break-after: always;"></div>

# updated!
由于同学们怨气太重，比赛被劝退啦！

~~所以上面的只能看着玩玩了~~

**但是**A,C可以看
芝士新的
| | a | b | c | d |
 :-----------: | :----------- | :----------- | :----------- | :----------- 
  源程序/输入/输出文件名| a.cpp/in/out |b.cpp/in/out|c.cpp/in/out|d.cpp/in/out
  测试点数目/个|2|10|10|10
  测试点等分|否|是|是|是
  时间限制/s| 1|1.5|1|8
 空间限制/MB |256|16|256|256

# A.a

芝士第一题

## 题目描述

定义一个函数 $f(x)$ 为将 $x$ 的十进制表示中的奇数数量，偶数数量和总数数量个数依次写下得到的数字**串**，**不忽略前导零**。例如 $f(\texttt{0}) = \texttt {011}$，$f(\texttt{1064}) = \texttt{134}$，$f(\texttt {822}) = \texttt {033}$，$f(\texttt{1092515503}) = \texttt{7310}$。

设 $g_k(x)$ 表示将将 $f(x)$ 迭代 $k$ 次得到的数字串对应的数字，即 $g_k(x) = f(f(\cdots f(x)))$（共有 $k$ 个 $f$）。

求 $\sum_{i = 0} ^ {10 ^ n - 1} g_k(i)$。

多测。


## 输入格式

第一行一个整数 $T$。

接下来 $T$ 行，每行两个整数 $n, k$ 表示一组数据。

## 输出格式

对每组数据，输出一行一个整数表示答案。

## 样例 #1

### 样例输入 #1

```
1
0 1
```

### 样例输出 #1

```
11
```

## 提示

对于所有数据，$1\leq T\leq 60$，$0\leq n < k \leq 10 ^ 5$，$\sum k\leq 10 ^ 5$。

- 测试点 1（$30$ 分）：$n\leq 5$，$k\leq 15$。  
- 测试点 2（$70$ 分）：无特殊限制。


<div STYLE="page-break-after: always;"></div>

# B.b


## 题目描述

一个数列 $a_n $，已知 $a_1$ 及 $a_2$ 两项。

数列 $a_n$ 满足递推式 $a_n=x \times a_{n-1}+ y \times a_{n-2}(n≥3).$

求 $\sum_{i=1}^na_i^2$

由于答案可能过大，对 $10^9+7$ 取模。

## 输入格式

第一行一个整数 $T$，即数据组数。

下面 $T$ 行，每行 $5$ 个整数，$n,a_1,a_2,x,y$，含义如上。

## 输出格式

共 $T$ 行，每行一个整数，即为每组数据的答案。

## 样例 #1

### 样例输入 #1

```
3
5 1 1 1 1
4 3 4 3 2
461564597527246 987489553 321654648 164165256 315648984
```

### 样例输出 #1

```
40
4193
480929868
```

## 提示

样例解释：

对于第一组样例，可知数列为 $1,1,2,3,5$，则答案是 $1^2+1^2+2^2+3^2+5^2=40$。

对于第二组样例，可知数列为 $3,4,18,62$，则答案是 $3^2+4^2+18^2+62^2=4193$。

~~第三组样例不予解释。~~

对于前 $20\%$ 的数据，保证 $x=y=1$。

对于 $100\%$ 的数据，$T=30000,1\le n \le 10^{18},1\le a_1,a_2 ,x,y \le 10^9$。
<div STYLE="page-break-after: always;"></div>

# C.c
芝士数据结构（显然）

## 题目描述

请写一个程序，要求维护一个数列，支持以下 $\text5$ 种操作：
| 格式 | 操作 |
 :-----------: | :----------- |
  $\text{0 l r}$| 把 $[l, r]$ 区间内的所有数全变成 $0$
  $\text{1 l r}$|把 $[l, r]$ 区间内的所有数全变成 $1$
  $\text{2 l r}$| 把 $[l,r]$ 区间内的所有数全部取反，也就是说把所有的 $0$ 变成 $1$，把所有的 $1$ 变成 $0$
 $\text{3 l r}$ |询问 $[l, r]$ 区间内总共有多少个 $1$
  $\text{4 l r}$| 询问 $[l, r]$ 区间内最多有多少个连续的 $1$
  


## 输入格式

第一行两个正整数 $n,m$，表示序列长度与操作个数。  
第二行包括 $n$ 个数，表示序列的初始状态。  
接下来 $m$ 行，每行三个整数，表示一次操作。

## 输出格式

对于每一个询问操作，输出一行一个数，表示其对应的答案。

## 样例 #1

### 样例输入 #1

```
10 10
0 0 0 1 1 0 1 0 1 1
1 0 2
3 0 5
2 2 2
4 0 4
0 3 6
2 3 7
4 2 8
1 0 5
0 5 6
3 3 9
```

### 样例输出 #1

```
5
2
6
5
```

## 提示

对于 $30\%$ 的数据，$1\le n,m \le 1000$；  
对于 $100\%$ 的数据，$1\le n,m \le 10^5$。

<div STYLE="page-break-after: always;"></div>

# D.d

## 题目背景

芝士最后一道题

**略微卡常，std最后一个点跑了994ms，大家注意**

## 题目描述



给定一棵 $n$ 个点的树，根节点为 $1$ 号点，第 $i$ 个点的点权为 $a_i$，$dep_u$ 表示 $u$ 点的深度，根节点的深度为 $1$，$q$ 次询问，每次给定两个整数 $x,h$，表示询问 $\bigoplus_{u\in son(x)\land dep_u-dep_x\le h}a_i$ 除以 $1000$ 后的值。

其中 $\bigoplus_{i=1}^ni$ 表示 $1\operatorname{xor} 2\operatorname{xor}\cdots\operatorname{xor} n$。

此处 $\land$ 是“且”，$\operatorname{xor}$ 是异或。

## 输入格式

第一行两个正整数 $n,m$，表示城市数和询问数。

第二行 $n$ 个正整数 $a_i$， 表示每座城市应缴的所得税额。

第三行 $n-1$ 个正整数，其中第 $i$ 个数 $f_i$ 表示城市 $i+1$ 与城市 $f_i$ 有一条路相连。

从第 $4$ 行开始 $m$ 行，每行两个正整数 $x,h$，表示一组询问。

## 输出格式

对于每组询问，输出一行，一个实数，表示这座城市收取的税额。

**答案保留三位小数。**

## 样例 #1

### 样例输入 #1

```
6 3
604 545 402 378 25 13
1 2 2 3 3
1 2
3 0
2 4
```

### 样例输出 #1

```
0.149
0.402
0.733
```

## 样例 #2

### 样例输入 #2

```
6 3
6 5 4 3 2 1
1 2 2 3 3
1 2
3 0
2 4
```

### 样例输出 #2

```
0.004
0.004
0.001
```

## 提示

对于 $30\%$ 的数据，$1\le n,m\le 10^3$。

对于 $70\%$ 的数据，$1\le n,m\le5 \times 10^4$。其中有 $20\%$ 的数据是链。

对于 $100\%$ 的数据，$1\le n,m\le 10^6$，$1 \le a_i \le 10^9$，$1\le x \le n$，$0 \le h \le n$。